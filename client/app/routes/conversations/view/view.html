<br><br>
<div class="container page-conversation-view">
  <div class="row">
    <div class="col-md-5">
      <ul class="list-group">
        <span ng-if="$ctrl.viewer.before.length > 0">
          <li ng-repeat="block in $ctrl.viewer.before" ng-include="'conversationBlock'" class="list-group-item"></li>
          <br><br>
        </span>
          <li class="list-group-item selectable-message" ng-class="{'selected-block': $ctrl.editing.s && !$ctrl.editing.p}" ng-click="$ctrl.setActive($ctrl.s); $ctrl.edit($ctrl.s)">
            <div class="message-container" ng-repeat="message in $ctrl.step[$ctrl.s].messages" >
              <div class="message-bubble message-app">{{ message }}</div>
            </div>
            <form ng-if="!$ctrl.editing.p">
              <input  /> <button>Add</button>
            </form>
          </li>
          <li class="list-group-item selectable-message" ng-class="{'selected-block': $ctrl.editing.s && $ctrl.editing.p}" ng-click="$ctrl.setActive($ctrl.s, $ctrl.p); $ctrl.edit($ctrl.s, $ctrl.p)">
            <div style="text-align:center">{{$ctrl.step[$ctrl.s].paths.length}}/{{$ctrl.step[$ctrl.s].paths.length}}</div>
            <div class="message-container message-container-user">
              <div class="message-bubble message-user">
                <span class="label label-default">
                  {{$ctrl.step[$ctrl.s].path[$ctrl.p].patterns.length}}
                </span>
                &nbsp;&nbsp;&nbsp;
                  {{ $ctrl.step[$ctrl.s].path[$ctrl.p].patterns[0].phrases[0] }}
              </div>

            </div>
            <div class="message-container message-app" ng-repeat="message in $ctrl.step[$ctrl.s].path[$ctrl.p].patterns[0].messages">
              <div class="message-bubble message-app">{{ message }}</div>
            </div>
            <form ng-if="$ctrl.editing.p">
              <input  /> <button>Add</button>
            </form>
          </li>
        <br><br>
        <li ng-if="$ctrl.viewer.after.length > 0" ng-repeat="block in $ctrl.viewer.after" ng-include="'conversationBlock'" class="list-group-item">
        </li>
      </ul>
    </div>
    <div class="col-md-7">
      <div ng-if="$ctrl.editing.s && !$ctrl.editing.p">
        Messages:
        Retries: 3<br>
        <br><br>

      </div>
      <div ng-if="$ctrl.editing.s && $ctrl.editing.p">
        Pattern Type: {{$ctrl.step[$ctrl.s].path[$ctrl.p].patterns[0].type}}<br>
        Next: {{$ctrl.step[$ctrl.s].path[$ctrl.p].next}}: {{$ctrl.step[$ctrl.s].path[$ctrl.p].stepId}}<br>
        <br><br>
        Reaction Messages:
      </div>
    </div>
  </div>
</div>

<script type="text/ng-template" id="conversationBlock">
  <div class="selectable-message" ng-click="$ctrl.setActive(block.s);$ctrl.edit()">
    <div class="message-container message-app" ng-repeat="message in $ctrl.step[block.s].messages" >
      <div class="message-bubble message-app">{{ message }}</div>
    </div>
  </div>
  <div class="selectable-message" ng-if="$ctrl.step[block.s].path[block.p]" ng-click="$ctrl.setActive(block.s, block.p)">
    <div class="message-container message-container-user">
      <div class="message-bubble message-user">{{ $ctrl.step[block.s].path[block.p].patterns[0].phrases[0] }}</div>
    </div>
    <div class="message-container message-app" ng-repeat="message in $ctrl.step[block.s].path[block.p].patterns[0].messages">
      <div class="message-bubble message-app">{{ message }}</div>
    </div>
  </div>
</script>

<!--
<h3>{{$ctrl.script.steps[$ctrl.activeStep].messages[0]}}</h3>
Max retries: <input><br>
Retry messages:
<ul><li>Didn't understand...</li></ul>
Confirm: <input type="checkbox"/><br>
Confirm messages:
<ul><li>You're sure it's ____...</li></ul>
<h3>Responses</h3>
<input />
<ul class="list-group">
  <li ng-repeat="response in $ctrl.script.steps[$ctrl.activeStep].responses" class="list-group-item selectable-message" ng-click="$ctrl.activeSubstep = $index">
    check if accepted, cycle sumbol if retry, hand stop if end, down arrow if passthrough {{response | responseShortname}}
  </li>
</ul>
Response data:<br>
min/max for number<br>
matching phrases for phrases<br>
entity for entity matching<br>-->
